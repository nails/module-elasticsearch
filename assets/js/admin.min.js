!function(){"use strict";window.NAILS.ADMIN.registerPlugin("nails/module-elasticsearch","Stats",new class{constructor(){document.getElementById("js-elasticsearch-stats")&&(this.loadStats(),document.getElementById("js-elasticsearch-stats-reload").addEventListener("click",(()=>{this.loadStats()})))}loadStats(){console.log("loading stats");let e=document.getElementById("js-elasticsearch-stats-loading"),t=document.getElementById("js-elasticsearch-stats-loaded");e.classList.remove("hidden"),t.classList.add("hidden"),$.get(window.SITE_URL+"api/elasticsearch/stats").done((s=>{e.classList.add("hidden"),t.classList.remove("hidden"),this.processStats(s.data)})).fail((t=>{let s;try{s=JSON.parse(t.responseText)}catch(e){s={status:500,error:"An unknown error occurred."}}e.className="alert alert-danger",laoding.innerHTML=s.error}))}processStats(e){console.log(e);let t="warning",s="warning",a="The health of the cluster is unknown.";switch(e.cluster.status){case"green":t="success",s="check",a="["+e.cluster.name+"] Cluster is fully functional.";break;case"yellow":t="warning",s="exclamation-triangle",a="["+e.cluster.name+"] Cluster is fully functional but some data has not yet been replicated.";break;case"red":t="warning",s="exclamation-triangle",a="["+e.cluster.name+"] Cluster is missing data."}let l=document.getElementById("js-elasticsearch-stats-cluster-health"),n=l.querySelector(".fa"),r=l.querySelector(".msg");l.className=`alert alert-${t}`,n.className=`fa fa-lg fa-${s}`,r.innerHTML=a;let c=document.getElementById("js-elasticsearch-stats-details");c.innerHTML="";for(let t in e.details)if(e.details.hasOwnProperty(t)){let s=document.createElement("tr"),a=document.createElement("td"),l=document.createElement("td");a.innerHTML=e.details[t].label,l.innerHTML=e.details[t].value,s.append(a),s.append(l),c.append(s)}}})}();